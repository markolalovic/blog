<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/blog/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/blog/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav ul li a { background-image: none; } .site-nav > ul.nav-category-list > li > button svg { transform: rotate(-90deg); } .site-nav > ul.nav-category-list > li.nav-list-item > ul.nav-list { display: block; } </style> <script src="/blog/assets/js/vendor/lunr.min.js"></script> <script src="/blog/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/blog/assets/icons/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Topological features applied to the MNIST data set | ML Blog</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="Topological features applied to the MNIST data set" /> <meta name="author" content="Marko Lalovic" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="The purpose of this tutorial is to give a friendly introduction on how to use the persistent homology that does not require substantial knowledge of topological methods. To illustrate the use of persistent homology in machine learning we apply it to the MNIST data set of handwritten digits. A very similar approach can be applied to any point cloud data and can be generalized to higher dimensions." /> <meta property="og:description" content="The purpose of this tutorial is to give a friendly introduction on how to use the persistent homology that does not require substantial knowledge of topological methods. To illustrate the use of persistent homology in machine learning we apply it to the MNIST data set of handwritten digits. A very similar approach can be applied to any point cloud data and can be generalized to higher dimensions." /> <link rel="canonical" href="http://localhost:4000/blog/tda-digits/" /> <meta property="og:url" content="http://localhost:4000/blog/tda-digits/" /> <meta property="og:site_name" content="ML Blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-09-25T00:00:00+02:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Topological features applied to the MNIST data set" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Marko Lalovic"},"dateModified":"2020-09-25T00:00:00+02:00","datePublished":"2020-09-25T00:00:00+02:00","description":"The purpose of this tutorial is to give a friendly introduction on how to use the persistent homology that does not require substantial knowledge of topological methods. To illustrate the use of persistent homology in machine learning we apply it to the MNIST data set of handwritten digits. A very similar approach can be applied to any point cloud data and can be generalized to higher dimensions.","headline":"Topological features applied to the MNIST data set","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/tda-digits/"},"url":"http://localhost:4000/blog/tda-digits/"}</script> <!-- End Jekyll SEO tag --> <!-- Load dark color theme --> <link id="dark-theme" rel="stylesheet" href="/blog/assets/css/just-the-docs-dark.css" media="(prefers-color-scheme: dark)" /> <!-- Fonts: post-font-family: "Noto Sans" heading-font-family: "Lato" mono-font-family: "Fira Code" --> <link rel="preconnect" href="https://fonts.googleapis.com" /> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /> <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"> <!-- MathJax config --> <script type="text/javascript"> window.MathJax = { tex: { packages: ["base", "ams", "newcommand"], inlineMath: [ ["$", "$"], ["\\(", "\\)"], ], tags: "ams", }, loader: { load: ["ui/menu", "[tex]/ams", "[tex]/newcommand"], versionWarnings: false, }, }; </script> <!-- MathJax snippet --> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" ></script> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div id="side-bar-component" class="side-bar"> <div class="site-header" role="banner"> <a href="/blog/" class="site-title lh-tight"> <p class="my-site-title">ML Blog</p> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"> <!-- Added `reversed` so that posts are sorted by date in reverse --><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --> <a href="/blog/" class="nav-list-link fs-5">Index</a><!-- changed typography: fw-400 fs-4 --></li></ul> <!-- Don't show my Posts collection name --><ul class="nav-list"> <!-- Added `reversed` so that posts are sorted by date in reverse --><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/max-cut-sdp/" class="nav-list-link fs-3 before-pseudo-class">Max-Cut and Goemans-Williamson</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/layout-optimization/" class="nav-list-link fs-3 before-pseudo-class">Layout optimization for a solar tower power plant</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/lasso-dual/" class="nav-list-link fs-3 before-pseudo-class">Lasso dual</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/tda-digits/" class="nav-list-link fs-3 before-pseudo-class">Topological features applied to the MNIST data set</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/water-towers/" class="nav-list-link fs-3 before-pseudo-class">Some math behind water towers</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/covid-calc/" class="nav-list-link fs-3 before-pseudo-class">Covid Calculator</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/direct-approach-to-fdr/" class="nav-list-link fs-3 before-pseudo-class">On Storey's direct approach to false discovery rates</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/ridge-regression/" class="nav-list-link fs-3 before-pseudo-class">Ridge regression</a></li><li class="nav-list-item"><!-- Added some >> pseudo class, but only to my Posts titles --> <!-- Changed typography: fw-400 --><!-- changed typography: fw-400 fs-4 --> <a href="/blog/ols-regression/" class="nav-list-link fs-3 before-pseudo-class">Multicollinearity effect on OLS regression</a></li></ul> </nav> <footer class="site-footer"></footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search ML Blog" aria-label="Search ML Blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <button id="toggle-theme-button" name="Swich Theme" class="toggle-btn site-button fw-500 fs-5" onclick="toggleTheme()"> <!-- Sun --> <svg width="24" height="24" id="light-icon" display="none"> <g transform="translate(0,1) scale( 0.9 )"> <circle cx="12" cy="12" r="6" fill="rgb(110, 110, 110)" /> <line id="ray" stroke="rgb(110, 110, 110)" stroke-width="2" stroke-linecap="round" x1="12" y1="1" x2="12" y2="3.3" ></line> <!-- rest of rays are just rotated top ray --> <use href="#ray" transform="rotate(45 12 12)" /> <use href="#ray" transform="rotate(90 12 12)" /> <use href="#ray" transform="rotate(135 12 12)" /> <use href="#ray" transform="rotate(180 12 12)" /> <use href="#ray" transform="rotate(225 12 12)" /> <use href="#ray" transform="rotate(270 12 12)" /> <use href="#ray" transform="rotate(315 12 12)" /> </g> </svg> <!-- Moon --> <svg width="24" height="24" id="dark-icon" display="none"> <g transform="translate(0,1) scale( 0.9 )"> <path fill="rgb(110, 110, 110)" d=" M 18, 4 A 10 10 0 1 0 18, 20 A 10 10 0 0 1 18, 4" /> </g> </svg> </button> </li> <li class="aux-nav-list-item"> <a href="https://lalovic.io" class="site-button fw-500 fs-5"> About </a> </li> </ul> </nav> <!-- Light and dark theme toggle --> <script> var currentTheme = ""; const toggleThemeButton = document.getElementById("toggle-theme-button"); const lightIcon = document.getElementById("light-icon"); const darkIcon = document.getElementById("dark-icon"); const defaultTheme = document.getElementsByTagName("link")[0]; const lightThemeHTML = '<link id="light-theme" rel="stylesheet" href="/blog/assets/css/just-the-docs-light.css"/>'; const darkThemeHTML = '<link id="dark-theme" rel="stylesheet" href="/blog/assets/css/just-the-docs-dark.css"/>'; if ( window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches ) { currentTheme = "dark"; toggleThemeButton.setAttribute("title", "Switch to light mode"); darkIcon.setAttribute("display", "none"); lightIcon.setAttribute("display", "block"); } else { currentTheme = "light"; toggleThemeButton.setAttribute("title", "Switch to dark mode"); darkIcon.setAttribute("display", "block"); lightIcon.setAttribute("display", "none"); } function removeBothThemes() { const lightTheme = document.getElementById("light-theme"); const darkTheme = document.getElementById("dark-theme"); if (lightTheme !== null) { lightTheme.remove(); } if (darkTheme !== null) { darkTheme.remove(); } } function darkOn() { removeBothThemes(); defaultTheme.insertAdjacentHTML("afterend", darkThemeHTML); currentTheme = "dark"; localStorage.setItem("currentThemeLS", "dark"); toggleThemeButton.setAttribute("title", "Switch to light mode"); lightIcon.setAttribute("display", "block"); darkIcon.setAttribute("display", "none"); } function lightOn() { removeBothThemes(); defaultTheme.insertAdjacentHTML("afterend", lightThemeHTML); currentTheme = "light"; localStorage.setItem("currentThemeLS", "light"); toggleThemeButton.setAttribute("title", "Switch to dark mode"); lightIcon.setAttribute("display", "none"); darkIcon.setAttribute("display", "block"); } function toggleTheme() { if (currentTheme == "dark") { lightOn(); } else { darkOn(); } } if (localStorage.getItem("currentThemeLS") !== null) { const currentThemeLS = localStorage.getItem("currentThemeLS"); if (currentThemeLS !== currentTheme) { if (currentThemeLS == "dark") { darkOn(); } else { lightOn(); } } } </script> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 class="fs-7">Topological features applied to the MNIST data set</h1> <p class="my-post-meta"> Marko Lalovic &nbsp; Sep 25, 2020 </p> <p class="post-content"> <strong>TLDR:</strong> A tutorial on extracting topological features that can be used as input to standard algorithms to obtain qualitative geometric information. </p> <div class="post-content"> <p>The purpose of this tutorial is to give a friendly introduction on how to use the persistent homology that does not require substantial knowledge of topological methods. To illustrate the use of persistent homology in machine learning we apply it to the MNIST data set of handwritten digits. A very similar approach can be applied to any point cloud data and can be generalized to higher dimensions.</p> <p>A pure topological classification cannot distinguish between individual numbers, as the numbers are topologically too similar. For example, numbers 6 and 9 are topologically the same if we use this style for writing numbers. Persistent homology, however, gives us more information. The process is described as follows and illustrated in <a href="#figure1">Figure 1</a>. Define a filtration on the vertices of the graph corresponding to the image pixels, adding vertices and edges as we sweep across the image (<a href="#figure1">Figure 1A,B</a>). This adds spatial information to the topological features. For example, though 6 and 9 both have a single loop, it will appear at different locations in the filtration. Then, compute the persistent homology given the simplex stream from the filtration to get the finite set of intervals called <em>Betti barcodes</em> (<a href="#figure1">Figure 1C</a>).</p> <div class="mono-italic"> Click to animate the diagram: </div> <p><button class="btn btn-blue" title="Run" id="runButton" onclick="run()">RUN</button></p> <div id="figure1" class="imgcap-nbd"> <img id="tda-example-viz-static" src="/blog/assets/posts/tda-digits/tda-example.svg" width="80%" class="invertImg" /> <div id="tda-example-viz-dynamic" class="div-for-inline-svg width80p"> <svg id="tda-example-viz" width="100%" viewBox="0 0 1024 380" xmlns="http://www.w3.org/2000/svg" display="none"> <!--G{} --> <g fill="none"> <g font-size="16px" style="font-family:sans-serif" text-anchor="end"> <path d="M40 358.4h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 358.4)">0</text> <path d="M40 329.45h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 329.45)">2</text> <path d="M40 300.51h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 300.51)">4</text> <path d="M40 271.56h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 271.56)">6</text> <path d="M40 242.62h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 242.62)">8</text> <path d="M40 213.67h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 213.67)">10</text> <path d="M40 184.73h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 184.73)">12</text> <path d="M40 155.78h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 155.78)">14</text> <path d="M40 126.84h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 126.84)">16</text> <path d="M40 97.89h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 97.89)">18</text> <path d="M40 68.94h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 68.94)">20</text> <path d="M40 40h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(40 40)">22</text> </g> <path d="M40 40h268.64v318.4H40zm328.64 0h268.64v318.4H368.64zm308.64 0H1004v72.8H677.28zm0 112.8H1004v72.8H677.28z" stroke-width=".5" stroke-opacity=".8" stroke="#000"> </path> </g> <path d="M368.64 329.45h268.64m-268.64-28.94h268.64m-268.64-28.95h268.64m-268.64-28.94h268.64m-268.64-28.95h268.64m-268.64-28.94h268.64m-268.64-28.95h268.64m-268.64-28.94h268.64M368.64 97.89h268.64M368.64 68.94h268.64" stroke="#d3d3d3"> </path> <g fill="none" font-size="16" style="font-family:sans-serif"> <g text-anchor="end"> <path d="M368.64 358.4h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 358.4)">0</text> <path d="M368.64 329.45h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 329.45)">2</text> <path d="M368.64 300.51h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 300.51)">4</text> <path d="M368.64 271.56h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 271.56)">6</text> <path d="M368.64 242.62h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 242.62)">8</text> <path d="M368.64 213.67h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 213.67)">10</text> <path d="M368.64 184.73h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 184.73)">12</text> <path d="M368.64 155.78h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 155.78)">14</text> <path d="M368.64 126.84h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 126.84)">16</text> <path d="M368.64 97.89h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 97.89)">18</text> <path d="M368.64 68.94h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 68.94)">20</text> <path d="M368.64 40h-6" stroke="#000"> </path> <text x="-9" dy=".32em" style="white-space:nowrap; fill:#000;" transform="translate(368.64 40)">22</text> </g> <g font-size="16px" style="font-family:sans-serif;text-anchor:middle;"> <path d="M677.28 118.8v-6H1004v6m-326.72-6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(677.28 112.8)">0</text> <path d="M706.98 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(706.98 112.8)">2</text> <path d="M736.68 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(736.68 112.8)">4</text> <path d="M766.38 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(766.38 112.8)">6</text> <path d="M796.09 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(796.09 112.8)">8</text> <path d="M825.79 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(825.79 112.8)">10</text> <path d="M855.49 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(855.49 112.8)">12</text> <path d="M885.2 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(885.2 112.8)">14</text> <path d="M914.9 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(914.9 112.8)">16</text> <path d="M944.6 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(944.6 112.8)">18</text> <path d="M974.3 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(974.3 112.8)">20</text> <path d="M1004 112.8v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(1004 112.8)">22</text> </g> </g> <path d="M706.98 40v72.8m29.7-72.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8M855.5 40v72.8M885.2 40v72.8M914.9 40v72.8M944.6 40v72.8M974.3 40v72.8" stroke="#d3d3d3"> </path> <g fill="none" font-size="16px" style="font-family:sans-serif;text-anchor:middle;"> <path d="M677.28 231.6v-6H1004v6m-326.72-6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(677.28 225.6)">0</text> <path d="M706.98 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(706.98 225.6)">2</text> <path d="M736.68 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(736.68 225.6)">4</text> <path d="M766.38 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(766.38 225.6)">6</text> <path d="M796.09 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(796.09 225.6)">8</text> <path d="M825.79 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(825.79 225.6)">10</text> <path d="M855.49 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(855.49 225.6)">12</text> <path d="M885.2 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(885.2 225.6)">14</text> <path d="M914.9 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(914.9 225.6)">16</text> <path d="M944.6 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(944.6 225.6)">18</text> <path d="M974.3 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(974.3 225.6)">20</text> <path d="M1004 225.6v6" stroke="#000"> </path> <text y="9" dy=".71em" style="white-space:nowrap; fill:#000;" transform="translate(1004 225.6)">22</text> </g> <path d="M706.98 152.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8m29.71-72.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8m29.7-72.8v72.8" stroke="#d3d3d3"> </path> <path id="tda-example-label-y" d="M680 299.38h50" stroke="red" stroke-width="2"> </path> <path id="tda-example-viz-labels" d="M379.63 11.71v-8.8h6.04c3.38 0 3.96 2.66 3.96 4.17 0 2.55-1.57 4.63-4.8 4.63zm9 .58c3.6-.68 5.74-2.66 5.74-5.21 0-3.08-2.92-5.73-8.23-5.73H371.7V2.9h3.6v19.7h-3.6v1.56h15.42c5.52 0 8.28-2.92 8.28-6.2 0-3.17-2.81-5.41-6.77-5.67zm-2.86 10.3h-6.14v-9.68h6.46c.67 0 2.24 0 3.38 1.4a6.18 6.18 0 0 1 1.1 3.65c0 .37 0 4.64-4.8 4.64zM57.32 2c-.37-.83-.73-.83-1.3-.83-.94 0-1.1.26-1.3.83l-8.24 20c-.2.52-.31.78-2.81.78h-.73v1.56l3.9-.1c1.31 0 3.13 0 4.38.1v-1.56c-.05 0-2.97 0-2.97-.42 0-.05.1-.36.16-.41l1.67-4.01h8.9l1.98 4.84H57.8v1.56c1.3-.1 4.42-.1 5.88-.1 1.3 0 4.22 0 5.42.1v-1.56h-3.23zM54.5 7.16l3.8 9.21h-7.6zm651.55-5.24c0-.62 0-.94-.63-.94-.31 0-.36.1-.62.32l-2.2 1.98a10.1 10.1 0 0 0-6.55-2.3c-8.28 0-13.34 4.95-13.34 11.77 0 6.83 5.06 11.78 13.34 11.78 6.25 0 10-4.07 10-7.92 0-.68-.26-.68-.84-.68-.41 0-.73 0-.73.57-.26 4.43-4.27 6.46-7.6 6.46-2.6 0-5.42-.78-7.13-2.81-1.57-1.93-1.98-4.37-1.98-7.4 0-1.87.1-5.41 2.24-7.65 2.13-2.19 5.05-2.55 6.77-2.55 3.59 0 6.72 2.55 7.44 6.77.1.62.16.67.89.67.88 0 .94-.05.94-.93zM650.2 84.74c-.03.04-.1.29-.1.32 0 .28.32.28.5.28.38 0 .38-.07.5-.47.07-.31 1.25-5.1 1.28-5.16.85 1.4 2.38 2 3.97 2 4 0 6.25-3.06 6.25-5.68 0-1.38-.62-2.13-1.28-2.63a4.67 4.67 0 0 0 1.53-3.28c0-1.69-1.25-2.66-3.12-2.66a7.03 7.03 0 0 0-6.5 5.1zm9.03-11.28c-.5.35-.97.35-1.25.35-.1 0-.97 0-.97-.16 0-.31.97-.31 1.25-.31.34 0 .6 0 .97.12zm.65-.68c-.65-.16-1.18-.16-1.59-.16-.62 0-2.25 0-2.25 1.06 0 .84 1.22.84 1.9.84.35 0 1.23 0 2.13-.37.16.28.22.69.22 1.03 0 .72-.5 3.13-1.12 4.16a3.3 3.3 0 0 1-2.85 1.65c-1.87 0-3.4-1.12-3.4-2.9 0-.4.09-.85.12-1.03l1.19-4.66c.62-2.19 3.03-4.22 5.4-4.22.75 0 1.2.38 1.2 1.13 0 .62-.48 2.68-.95 3.46zM671.2 80c0-1.72-.18-4.72-3.74-4.72-3.57 0-3.75 3.03-3.75 4.72 0 1.75.22 4.6 3.75 4.6s3.75-2.82 3.75-4.6zm-3.74 3.97a1.8 1.8 0 0 1-1.19-.44c-.38-.34-.63-.53-.63-3.72 0-.93 0-2.06.16-2.71.22-.9 1.1-1.16 1.66-1.16.53 0 1.43.22 1.65 1.19.16.65.16 1.81.16 2.68 0 1 0 2-.13 2.79-.21 1.12-1.15 1.37-1.68 1.37zm-16.98 113.56c-.03.03-.09.28-.09.32 0 .28.31.28.5.28.38 0 .38-.06.5-.47.06-.31 1.25-5.1 1.28-5.16.84 1.4 2.38 2 3.97 2 4 0 6.25-3.06 6.25-5.68 0-1.38-.63-2.13-1.28-2.63a4.67 4.67 0 0 0 1.53-3.28c0-1.69-1.25-2.66-3.13-2.66a7.03 7.03 0 0 0-6.5 5.1zm9.03-11.28c-.5.35-.96.35-1.25.35-.09 0-.96 0-.96-.16 0-.31.96-.31 1.25-.31.34 0 .59 0 .96.12zm.66-.69c-.66-.15-1.19-.15-1.6-.15-.62 0-2.24 0-2.24 1.06 0 .85 1.22.85 1.9.85.35 0 1.22 0 2.13-.38.15.28.22.69.22 1.03 0 .72-.5 3.13-1.13 4.16-.62 1-1.6 1.65-2.84 1.65-1.88 0-3.4-1.12-3.4-2.9 0-.4.09-.85.12-1.03l1.18-4.66c.63-2.19 3.03-4.22 5.41-4.22.75 0 1.19.38 1.19 1.13 0 .62-.47 2.68-.94 3.46zm8.61 3.02c0-.5-.09-.5-.68-.5-.88.72-2 .91-3.13.91h-.34v.78h.34a7.9 7.9 0 0 0 2-.28v6.97h-2.19v.78c.66-.06 2.35-.06 3.1-.06l1.5.03c.44 0 1.16 0 1.56.03v-.78h-2.15zm85.8 105.1c.13-.37.13-.4.13-.6 0-.46-.37-.73-.8-.73a1.23 1.23 0 0 0-.9.54l-.38 1.46c-.21.67-.37 1.42-.53 2.14l-1.23 4.8c-.08.37-1.25 2.24-2.99 2.24-1.33 0-1.62-1.18-1.62-2.16 0-1.2.45-2.88 1.33-5.2.4-1.1.53-1.39.53-1.92a2.1 2.1 0 0 0-2.16-2.19c-2.53.03-3.5 3.9-3.5 4.1 0 .27.28.27.28.27.32 0 .32-.08.42-.48.75-2.5 1.79-3.3 2.72-3.3.22 0 .67 0 .67.82 0 .67-.3 1.4-.45 1.87a17.12 17.12 0 0 0-1.55 5.6c0 2.4 1.65 3.18 3.25 3.18a3.7 3.7 0 0 0 2.67-1.2 10.5 10.5 0 0 1-1.7 4.1c-.73.88-1.71 1.68-2.94 1.68-.37 0-1.6-.08-2.03-1.12.4 0 .8 0 1.12-.34.34-.26.54-.65.54-1.07 0-.85-.7-.93-.96-.93-.62 0-1.5.45-1.5 1.7 0 1.34 1.18 2.35 2.83 2.35 2.72 0 5.47-2.4 6.21-5.41zm0 0"> </path> </svg> </div> <div class="thecap margin-top-correct"> Figure 1: Applying this technique on (A) an image of a handwritten digit 8, (B) extracted embedded graph and (C) the resulting Betti barcodes. </div> </div> <!-- Run viz --> <script> function drawRect(name, x, y, w, h, rectStyle) { var aRect = document.createElementNS(svgns, 'rect'); aRect.setAttributeNS(null, "id", name); aRect.setAttribute('x', x); aRect.setAttribute('y', y); aRect.setAttribute('width', w); aRect.setAttribute('height', h); aRect.setAttributeNS(null, "style", rectStyle); svg.appendChild(aRect); } function drawPoint(name, x, y) { var size = 3.3; var circle = document.createElementNS(svgns, "circle"); circle.setAttributeNS(null, "id", name); circle.setAttributeNS(null, "cx", x); circle.setAttributeNS(null, "cy", y); circle.setAttributeNS(null, "r", size); circle.setAttributeNS(null, "style", pointStyle); svg.appendChild(circle); return circle; } function drawLine(name, x1, y1, x2, y2, lineStyle) { var aLine = document.createElementNS(svgns, "line"); aLine.setAttributeNS(null, "id", name); aLine.setAttributeNS(null, "x1", x1); aLine.setAttributeNS(null, "y1", y1); aLine.setAttributeNS(null, "x2", x2); aLine.setAttributeNS(null, "y2", y2); aLine.setAttributeNS(null, "style", lineStyle); svg.appendChild(aLine); return aLine; } function updateLine(aLine, x1, y1, x2, y2) { aLine.setAttributeNS(null, "x1", x1); aLine.setAttributeNS(null, "y1", y1); aLine.setAttributeNS(null, "x2", x2); aLine.setAttributeNS(null, "y2", y2); } function update(t) { y1 = rangeY[0] + stepY * t; y2 = rangeY[0] + stepY * t; x1 = rangeBettiX[0] + stepBettiX * t; updateLine(sweepLineDigit, rangeDigitX[0], y1, rangeDigitX[1], y2); updateLine(sweepLineGraph, rangeX[0], y1, rangeX[1], y2); updateLine(sweepLineBetti0, x1, rangeBettiY0[0], x1, rangeBettiY0[1]); updateLine(sweepLineBetti1, x1, rangeBettiY1[0], x1, rangeBettiY1[1]); bar0X1 = rangeBettiX[0] + stepBettiX * birthTimes[0][0]; bar0X2 = Math.max(bar0X1, rangeBettiX[0] + stepBettiX * t); bar0Y1 = rangeBettiY0[0] + bettiHeight / 2; updateLine(barcode0, bar0X1, bar0Y1, bar0X2, bar0Y1, bettiLineStyle); bar10X1 = rangeBettiX[0] + stepBettiX * birthTimes[1][0]; bar10X2 = Math.max(bar10X1, rangeBettiX[0] + stepBettiX * t); bar10Y1 = rangeBettiY1[0] + bettiHeight / 3; updateLine(barcode10, bar10X1, bar10Y1, bar10X2, bar10Y1, bettiLineStyle); bar11X1 = rangeBettiX[0] + stepBettiX * birthTimes[1][1]; bar11X2 = Math.max(bar11X1, rangeBettiX[0] + stepBettiX * t); bar11Y1 = rangeBettiY1[0] + 2 * bettiHeight / 3; updateLine(barcode11, bar11X1, bar11Y1, bar11X2, bar11Y1, bettiLineStyle); const nodesTimeT = nodes.filter((node) => (node.time === t) || (node.time === t - 1)); const edgestTimeT = edges.filter((edge) => edge.time === t); edgestTimeT.forEach(function(edge) { /* edge: {source: '1', target: '2', time: 2} */ source = parseInt(edge.source) - 1; target = parseInt(edge.target) - 1; x1 = rangeX[0] + stepX * nodes[source].metadata.x; y1 = rangeY[0] + stepY * nodes[source].metadata.y; x2 = rangeX[0] + stepX * nodes[target].metadata.x; y2 = rangeY[0] + stepY * nodes[target].metadata.y; lines.push(drawLine("edge", x1, y1, x2, y2, edgeStyle)); }); nodesTimeT.forEach(function(node) { /* node: {id: '1', time: 2, metadata: {x: 3, y: 2}} */ nodeName = node.id; nodeX = rangeX[0] + stepX * node.metadata.x; nodeY = rangeY[0] + stepY * node.metadata.y; points.push(drawPoint(nodeName, nodeX, nodeY)); }); } function removeElements() { /* clear arrays for points and lines on re-runs */ lines.forEach(function(line) { svg.removeChild(line); }); points.forEach(function(point) { svg.removeChild(point); }); points = []; lines = []; } /* Function run() to animate the diagram */ function run() { removeElements(); var button = document.getElementById("runButton"); button.disabled = true; /* remove static svg and add a dummy element after viz element */ const svgStatic = document.getElementById("tda-example-viz-static"); if (svgStatic !== null) { svgStatic.remove(); const tdaVizElement = document.getElementById("tda-example-viz-dynamic"); const tdaVizDummy = '<div id="tda-example-viz-dummy" class="div-dummy">'; tdaVizElement.insertAdjacentHTML("afterend", tdaVizDummy); } /* show the viz svg */ svg.setAttribute("display", "block"); var step = 1; var t = 0; var id = null; clearInterval(id); id = setInterval(frame, 80); function frame() { if (t < 22) { t += step; update(t); } else { clearInterval(id); button.disabled = false; } } } const svgns = "http://www.w3.org/2000/svg"; var svg = document.getElementById('tda-example-viz'); /* chart dimensions */ const chartWindowWidth = 1024; const chartWindowHeight = 380; const chartWidth = 268.64; const chartHeight = 318.4; const chartSpacing = 40; /* points and lines styles */ var pointStyle = "fill: black; stroke: white; stroke-width: 0.1px"; var edgeStyle = "stroke: #0062ff; stroke-width: 2px;"; var bettiLineStyle = "stroke: #0062ff; stroke-width: 10px"; var sweepLineStyle = "stroke: red; stroke-width: 2px"; /** * A - Handwritten number * */ const data = [[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,203,229,32],[0,0,0,0,0,0,0,0,0,0,26,47,47,30,95,254,215,13],[0,0,0,0,0,0,45,154,185,185,223,253,253,133,175,255,188,19],[0,0,0,0,0,0,110,253,253,253,246,161,228,253,253,254,92,0],[0,0,0,0,0,128,245,253,158,137,21,0,48,233,253,233,8,0],[0,0,0,0,0,139,254,223,25,0,0,36,170,254,244,106,0,0],[0,0,0,0,0,55,212,253,161,11,26,178,253,236,113,0,0,0],[0,0,0,0,0,7,155,253,228,80,223,253,253,109,0,0,0,0],[0,0,0,0,0,0,141,253,253,253,254,253,154,29,0,0,0,0],[0,0,0,0,0,0,110,253,253,253,254,179,38,0,0,0,0,0],[0,0,0,0,0,3,171,254,254,254,179,0,0,0,0,0,0,0],[0,0,0,0,0,171,253,253,253,253,178,0,0,0,0,0,0,0],[0,0,0,26,123,254,253,203,156,253,200,0,0,0,0,0,0,0],[0,0,0,93,253,254,121,13,93,253,158,0,0,0,0,0,0,0],[0,0,64,239,253,76,8,32,219,253,126,0,0,0,0,0,0,0],[0,0,133,254,191,0,5,108,234,254,106,0,0,0,0,0,0,0],[0,0,132,253,190,5,85,253,236,154,0,0,0,0,0,0,0,0],[0,0,153,253,169,192,253,253,77,0,0,0,0,0,0,0,0,0],[0,0,112,253,253,254,236,129,9,0,0,0,0,0,0,0,0,0],[0,0,17,118,243,191,113,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]; const nRows = data.length; const nCols = data[0].length; rangeDigitX = [chartSpacing, chartSpacing + chartWidth]; rangeDigitY = [chartSpacing, chartSpacing + chartHeight]; pixelWidth = (rangeDigitX[1] - rangeDigitX[0])/nCols; pixelHeight = (rangeDigitY[1] - rangeDigitY[0])/nRows; /* grayscale handwritten number */ for (var i = 0; i < nRows; i++) { for (var j = 0; j < nCols; j++) { pixelName = `pixel${i}${j}`; pixelX = rangeDigitX[0] + j * pixelWidth; pixelY = rangeDigitY[0] + i * pixelHeight; /* brightness = 255 - brightness, for black on white image */ b = 255 - data[i][j]; pixelStyle = `fill:rgb(${b}, ${b}, ${b});`; drawRect(pixelName, pixelX, pixelY, pixelWidth, pixelHeight, pixelStyle); } } sweepLineDigit = drawLine( "sweep-line-digit", rangeDigitX[0], rangeDigitY[1], rangeDigitX[1], rangeDigitY[1], sweepLineStyle ); /** * B - Graph * */ const graphDataJSON = '{"graph": {"name": "digit-graph", "type": "filtration", "nodes": [{"id": "1", "time": 2, "metadata": {"x": 3, "y": 2}}, {"id": "2", "time": 2, "metadata": {"x": 4, "y": 2}}, {"id": "3", "time": 3, "metadata": {"x": 2, "y": 3}}, {"id": "4", "time": 3, "metadata": {"x": 5, "y": 3}}, {"id": "5", "time": 3, "metadata": {"x": 6, "y": 3}}, {"id": "6", "time": 4, "metadata": {"x": 2, "y": 4}}, {"id": "7", "time": 4, "metadata": {"x": 7, "y": 4}}, {"id": "8", "time": 5, "metadata": {"x": 2, "y": 5}}, {"id": "9", "time": 5, "metadata": {"x": 7, "y": 5}}, {"id": "10", "time": 6, "metadata": {"x": 3, "y": 6}}, {"id": "11", "time": 6, "metadata": {"x": 8, "y": 6}}, {"id": "12", "time": 7, "metadata": {"x": 4, "y": 7}}, {"id": "13", "time": 7, "metadata": {"x": 8, "y": 7}}, {"id": "14", "time": 8, "metadata": {"x": 5, "y": 8}}, {"id": "15", "time": 8, "metadata": {"x": 8, "y": 8}}, {"id": "16", "time": 9, "metadata": {"x": 6, "y": 9}}, {"id": "17", "time": 9, "metadata": {"x": 7, "y": 9}}, {"id": "18", "time": 10, "metadata": {"x": 7, "y": 10}}, {"id": "19", "time": 11, "metadata": {"x": 7, "y": 11}}, {"id": "20", "time": 12, "metadata": {"x": 7, "y": 12}}, {"id": "21", "time": 12, "metadata": {"x": 8, "y": 12}}, {"id": "22", "time": 12, "metadata": {"x": 9, "y": 12}}, {"id": "23", "time": 13, "metadata": {"x": 6, "y": 13}}, {"id": "24", "time": 13, "metadata": {"x": 10, "y": 13}}, {"id": "25", "time": 13, "metadata": {"x": 11, "y": 13}}, {"id": "26", "time": 14, "metadata": {"x": 6, "y": 14}}, {"id": "27", "time": 14, "metadata": {"x": 12, "y": 14}}, {"id": "28", "time": 15, "metadata": {"x": 6, "y": 15}}, {"id": "29", "time": 15, "metadata": {"x": 12, "y": 15}}, {"id": "30", "time": 16, "metadata": {"x": 6, "y": 16}}, {"id": "31", "time": 16, "metadata": {"x": 13, "y": 16}}, {"id": "32", "time": 17, "metadata": {"x": 7, "y": 17}}, {"id": "33", "time": 17, "metadata": {"x": 13, "y": 17}}, {"id": "34", "time": 18, "metadata": {"x": 8, "y": 18}}, {"id": "35", "time": 18, "metadata": {"x": 9, "y": 18}}, {"id": "36", "time": 18, "metadata": {"x": 10, "y": 18}}, {"id": "37", "time": 18, "metadata": {"x": 11, "y": 18}}, {"id": "38", "time": 18, "metadata": {"x": 12, "y": 18}}, {"id": "39", "time": 18, "metadata": {"x": 14, "y": 18}}, {"id": "40", "time": 19, "metadata": {"x": 14, "y": 19}}, {"id": "41", "time": 20, "metadata": {"x": 15, "y": 20}}], "edges": [{"source": "1", "target": "2", "time": 2}, {"source": "1", "target": "3", "time": 3}, {"source": "2", "target": "4", "time": 3}, {"source": "4", "target": "5", "time": 3}, {"source": "3", "target": "6", "time": 4}, {"source": "5", "target": "7", "time": 4}, {"source": "6", "target": "8", "time": 5}, {"source": "7", "target": "9", "time": 5}, {"source": "8", "target": "10", "time": 6}, {"source": "9", "target": "11", "time": 6}, {"source": "10", "target": "12", "time": 7}, {"source": "11", "target": "13", "time": 7}, {"source": "12", "target": "14", "time": 8}, {"source": "13", "target": "15", "time": 8}, {"source": "14", "target": "16", "time": 9}, {"source": "15", "target": "17", "time": 9}, {"source": "16", "target": "18", "time": 10}, {"source": "17", "target": "18", "time": 10}, {"source": "18", "target": "19", "time": 11}, {"source": "19", "target": "21", "time": 12}, {"source": "20", "target": "21", "time": 12}, {"source": "21", "target": "22", "time": 12}, {"source": "20", "target": "23", "time": 13}, {"source": "22", "target": "24", "time": 13}, {"source": "24", "target": "25", "time": 13}, {"source": "23", "target": "26", "time": 14}, {"source": "25", "target": "27", "time": 14}, {"source": "26", "target": "28", "time": 15}, {"source": "27", "target": "29", "time": 15}, {"source": "28", "target": "30", "time": 16}, {"source": "29", "target": "31", "time": 16}, {"source": "30", "target": "32", "time": 17}, {"source": "31", "target": "33", "time": 17}, {"source": "32", "target": "34", "time": 18}, {"source": "34", "target": "35", "time": 18}, {"source": "35", "target": "36", "time": 18}, {"source": "36", "target": "37", "time": 18}, {"source": "37", "target": "38", "time": 18}, {"source": "33", "target": "38", "time": 18}, {"source": "33", "target": "39", "time": 18}, {"source": "39", "target": "40", "time": 19}, {"source": "40", "target": "41", "time": 20}]}}'; const nodes = JSON.parse(graphDataJSON).graph.nodes; const edges = JSON.parse(graphDataJSON).graph.edges; /* initialize arrays for points and lines */ var points = []; var lines = []; /* * Set scales * scaleX: [0, 17] -> rangeX * scaleY: [0, 22] -> rangeY */ rangeX = [100 + chartWidth, 100 + 2 * chartWidth]; rangeY = [chartSpacing + chartHeight, chartSpacing]; stepX = (rangeX[1] - rangeX[0])/17; stepY = (rangeY[1] - rangeY[0])/22; /* initialize sweep line for graph */ sweepLineGraph = drawLine( "sweep-line-graph", rangeX[0], rangeY[0], rangeX[1], rangeY[0], sweepLineStyle); /** * C - Betti barcodes * */ bettiX = 2 * chartWidth + 100 + chartSpacing; bettiWidth = chartWindowWidth - bettiX - chartSpacing / 2; bettiHeight = 1/3 * (chartWindowHeight - 4 * chartSpacing) - 1; rangeBettiX = [bettiX, bettiX + bettiWidth]; rangeBettiY0 = [chartSpacing, chartSpacing + bettiHeight]; rangeBettiY1 = [ 2 * chartSpacing + bettiHeight, 2 * chartSpacing + 2 * bettiHeight ]; stepBettiX = (rangeBettiX[1] - rangeBettiX[0])/22; /* initialize betti sweep lines */ sweepLineBetti0 = drawLine( "sweep-line-betti-0", rangeBettiX[0], rangeBettiY0[0], rangeBettiX[0], rangeBettiY0[1], sweepLineStyle ); sweepLineBetti1 = drawLine( "sweep-line-betti-1", rangeBettiX[0], rangeBettiY1[0], rangeBettiX[0], rangeBettiY1[1], sweepLineStyle ); /* initialize barcodes */ birthTimes = { 0: [2], 1: [18, 10] }; barcode0 = drawLine("barcode-0", 0, 0, 0, 0, bettiLineStyle); barcode10 = drawLine("barcode-10", 0, 0, 0, 0, bettiLineStyle); barcode11 = drawLine("barcode-10", 0, 0, 0, 0, bettiLineStyle); </script> <p>Finally, extract 4 features from the k-dimensional barcode from the invariants discussed in <a class="citation" href="#Adcock2013">(Adcock et al., 2013)</a>. For each of 4 sweep directions: top, bottom, right, left and dimensions: 0 and 1, compute 4 features. This gives a total of 32 features per image. On the extracted features from a set of images, we then apply a support vector machine (SVM) learning algorithm to classify the images.</p> <p>This blog post starts by a short introduction to Topological Data Analysis and Computational Topology. Next, the extraction of topological features is explained. Finally, the empirical classification results on a subset of the MNIST database are presented including the evaluation.</p> <p>The aim is to demonstrate the classification potential of the technique and not to outperform the existing models. For a more interesting example of using this technique on a clinical data set to classify hepatic lesions, see <a class="citation" href="#Adcock2013">(Adcock et al., 2013)</a>.</p> <p>All scripts are available on GitHub <a href="https://github.com/markolalovic/tda-digits">repository</a> including a processed version of the dataset. Also, freely available computational topology package <a href="https://github.com/mrzv/dionysus">Dionysus 2</a> is used for the computation of persistent homology.</p> <h2 class="no_toc text-delta" id="table-of-contents">Table of contents</h2> <ol id="markdown-toc"> <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li> <li><a href="#terminology" id="markdown-toc-terminology">Terminology</a></li> <li><a href="#extracting-the-graph-structure" id="markdown-toc-extracting-the-graph-structure">Extracting the graph structure</a></li> <li><a href="#extracting-the-topological-features" id="markdown-toc-extracting-the-topological-features">Extracting the topological features</a></li> <li><a href="#empirical-results" id="markdown-toc-empirical-results">Empirical results</a></li> <li><a href="#source-code" id="markdown-toc-source-code">Source code</a></li> <li><a href="#references" id="markdown-toc-references">References</a></li> </ol> <h2 id="introduction">Introduction</h2> <p>Persistent homology is a fascinating mathematical tool that continues to be studied, developed, and applied. Topology applied to real-world data sets using persistent homology has begun to look for applications in machine learning, including deep learning <a class="citation" href="#Gabrielsson2020">(Br√ºel-Gabrielsson et al., 2020)</a>. Topology is mainly used in a pre-processing step to provide robust features for learning. The developed topological techniques, mostly deal with point clouds, i.e. finite sets of data points in space. Point clouds are typically captured by a variety of imaging devices, such as MRI or CT scanners. With the greater availability of such devices, this type of data is being generated at an increasing rate. Our data is often a finite set of noisy samples from some underlying space. The data sets are often very noisy and contain a lot of missing information, especially biological data sets. Our ability to analyze this data, both in terms of the amount and the nature of the data, is getting out of step with the data we generate <a class="citation" href="#Carlsson2009">(Carlsson, 2009)</a>. Topology can be used to make a useful contribution to the analysis of such data sets and it is especially helpful in studying them qualitatively.</p> <p>The problem we are trying to solve in this tutorial is how to extract the topological features that can be used as an input to standard machine learning algorithms. We will use a similar approach as described in <a class="citation" href="#Adcock2013">(Adcock et al., 2013)</a>. From each image, we first construct a graph, where pixels of the image correspond to vertices of the graph and we add edges between adjacent pixels (<a href="#figure2">Figure 2A,B</a>). We then extract 0- and 1-dimensional topological features called <em>Betti numbers</em> denoted by $\beta_{0}$ and $\beta_{1}$. For example, a torus has one connected component giving $\beta_{0} = 1$, and two cycles or loops, giving $\beta_{1} = 2$ (<a href="#figure2">Figure 2C</a>).</p> <div id="figure2" class="imgcap-nbd"> <img src="/blog/assets/posts/tda-digits/intro-figure.png" width="60%" class="invertImg" /> <div class="thecap"> Figure 2: (A) handwritten digits (B) preprocessing and (C) a torus with two cycles on its surface. </div> </div> <h2 id="terminology">Terminology</h2> <ul> <li><em>Topology</em> is a branch of mathematics that deals with qualitative geometric information. This includes the classification of loops and higher-dimensional surfaces.</li> <li><em>Topological data analysis</em> and <em>computational topology</em> deal with the study of topology using a computer.</li> <li><em>Persistent homology</em> is an algebraic method for discerning topological features of data.</li> <li><em>Connected component</em> (or connected cluster of points) is a 0-dimensional feature and <em>cycle</em> (or <em>loop</em>) is a 1-dimensional feature.</li> <li><em>Simplicial complex</em> is a set composed of points, line segments, triangles, and their n-dimensional counterparts.</li> <li><em>Filtration</em> is the sequence of simplicial complexes, with an inclusion map from each simplicial complex to the next.</li> <li><em>Barcode</em> is a visual representation of the persistence of the topological features. Longer bars represent significant features of the data. Shorter bars are due to irregularities or noise.</li> </ul> <h2 id="extracting-the-graph-structure">Extracting the graph structure</h2> <p>The pre-processing steps to expose the topology of the digits, shown in the image of a handwritten digit 8 in <a href="#figure3">Figure 3</a>, are as follows.</p> <ul> <li>Load the MNIST image of a handwritten digit.</li> <li>Produce a binary image by thresholding.</li> <li>Reduce the image to a skeleton of 1-pixel width using the popular <a href="https://github.com/linbojin/Skeletonization-by-Zhang-Suen-Thinning-Algorithm">Zhang-Suen</a> thinning algorithm.</li> <li>Construct a graph $G$ from the skeleton.</li> </ul> <div id="figure3" class="imgcap"> <img src="/blog/assets/posts/tda-digits/1_original-image.png" alt="original image" style="width:23%" class="invertImg" /> <img src="/blog/assets/posts/tda-digits/2_binary-image.png" alt="binary image" style="width:23%" class="invertImg" /> <img src="/blog/assets/posts/tda-digits/3_skeleton.png" alt="skeleton" style="width:23%" class="invertImg" /> <img src="/blog/assets/posts/tda-digits/4_graph.svg" alt="graph" style="width:21.2%" class="invertImg" /> <div class="thecap"> Figure 3: Pre-procesing steps: the original image, binary image, skeleton and extracted graph. </div> </div> <p>To construct the graph $G$ from the 1-pixel width skeleton, we treat the pixels of the skeleton as vertices of $G$ and add the edges between adjacent vertices and then remove all created cycles of length 3. Intuitively, we connect the points while trying not to create new topological features. The result for the image of a handwritten digit 8 is a graph in <a href="#figure3">Figure 3</a>. The resulting graph in this example consists of one connected component with two cycles, so no new topological features were added.</p> <h2 id="extracting-the-topological-features">Extracting the topological features</h2> <p>Construct a simplex stream for computing the persistent homology using the following filtration on the graph $G$ embedded in the plane. Sweep across the plane while adding the vertices and edges of graph $G$. From the simplex stream, compute the persistent homology to get the Betti barcodes. The <a href="https://github.com/mrzv/dionysus">Dionysus 2</a> package can be used for the computation of persistent homology. See the package documentation <a class="citation" href="#Dionysus2">(Morozov, 2020)</a> for details.</p> <p><a href="#figure4">Figure 4</a> shows the result of this technique applied on the image of a handwritten digit 8. In this example, we sweep across the plane to the top in a vertical direction $y \in (-\infty, \infty)$.</p> <div id="figure4" class="imgcap-nbd"> <img src="/blog/assets/posts/tda-digits/tda-example.svg" width="80%" class="invertImg" /> <div class="thecap"> Figure 4: Result of applying this technique on (A) an image of a handwritten digit 8, (B) extracted embedded graph and (C) the resulting Betti barcodes at $y = 22$. </div> </div> <div class="mono-italic"> Interactive example: </div> <div class="mono-italic"> <a href="https://markolalovic.github.io/tda-digits">https://markolalovic.github.io/tda-digits</a> </div> <p>Betti 0 barcode $\beta_{0}$ consists of one interval $[2, \infty)$, which clearly shows the single connected component with the birth time of 2 when the first vertex of $G$ is added.</p> <p>Betti 1 barcode $\beta_{1}$ consists of two intervals $[10, \infty)$ and $[18, \infty)$, with birth times of 10 and 18 corresponding to the births of the two cycles. The birth of the cycle is the value of $y$ when the loop closes in the embedded graph $G$ as we sweep to the top.</p> <p>Finally, extract the following features from each of the k-dimensional Betti barcodes in the following way. Denote the endpoints of Betti barcode intervals with:</p> \[x_{1}, y_{1}, ..., x_{n}, y_{n}\] <p>where $x_{i}$ represents the beginning and $y_{i}$ the end of each interval. From the endpoints compute 4 features from the invariants discussed in <a class="citation" href="#Adcock2013">(Adcock et al., 2013)</a> that take into account all of the bars lengths and endpoints:</p> \[\begin{align*} f_{1}&amp;=\sum_{i} x_{i} (y_{i} - x_{i}) \\ f_{2}&amp;=\sum_{i} (y_{\max} - y_{i})(y_{i} - x_{i}) \\ f_{3}&amp;=\sum_{i} (y_{\max} - y_{i})^{2} (y_{i} - x_{i})^{4} \\ f_{4}&amp;=\sum_{i} x_{i}^{2} (y_{i} - x_{i})^{4} \\ \end{align*}\] <p>For each of the 4 sweep directions: top, bottom, right, left and for each $k$-dimensional Betti barcode, $k = 0, 1$, we compute the defined 4 features $f_{1}, \dots, f_{4}$. This gives us a total of $4 \cdot 2 \cdot 4 = 32$ features per image.</p> <h2 id="empirical-results">Empirical results</h2> <p>Data set consisted of extracted topological features of 10000 images of handwritten digits from MNIST database. Data set was split 50:50 in train and test set so that each had 5000 examples. SVM with RBF kernel was used for classification of the images based on the extracted topological features. The empirical classification results are as follows. Accuracy on the train set using 10-fold cross-validation was $0.88 (\pm 0.05)$. Accuracy on the test set was 0.89.</p> <p>We now examine the common misclassifications. There were only 3 examples of the number 2 being mistaken for number 0, they are shown in <a href="#figure5">Figure 5</a>. The reason is that the number 2 was written with a loop that appears in the region that is close to the loop in number 0.</p> <div id="figure5" class="imgcap-nbd"> <img src="/blog/assets/posts/tda-digits/miss-2.png" width="60%" class="invertImg" /> <div class="thecap"> Figure 5: Examples of number 2 being mistaken for number 0. </div> </div> <p>For number 5 we got the lowest F1 score of 0.75. It was misclassified as number 2 in 32 examples in the test set. The first three examples are shown in <a href="#figure6">Figure 6</a>. This was expected since these two numbers are topologically the same with no topological features (e.g. loops) appearing in different regions.</p> <div id="figure6" class="imgcap-nbd"> <img src="/blog/assets/posts/tda-digits/miss-5.png" width="60%" class="invertImg" /> <div class="thecap"> Figure 6: Examples of number 5 being mistaken for number 2. </div> </div> <p>Number 8 was misclassified as number 4 in 21 examples from the test set. The first three examples are shown in <a href="#figure7">Figure 7</a>. We see the stylistic problems that caused the misclassifications. The top loop of number 8 was not closed which made it topologically more similar to number 4 written with a loop.</p> <div id="figure7" class="imgcap-nbd"> <img src="/blog/assets/posts/tda-digits/miss-8.png" width="60%" class="invertImg" /> <div class="thecap"> Figure 7: Examples of number 8 being mistaken for number 4. </div> </div> <h2 id="source-code">Source code</h2> <p>The repository containing all Python scripts for this tutorial including the processed version of the data set is available here:</p> <div class="mono-italic"> <a href="https://github.com/markolalovic/tda-digits">https://github.com/markolalovic/tda-digits</a> </div> <h2 id="references">References</h2> <ol class="bibliography"><li><span id="Adcock2013">Adcock, A., Carlsson, E., &amp; Carlsson, G. (2013). <i>The Ring of Algebraic Functions on Persistence Bar Codes</i>. <a href="https://arxiv.org/abs/1304.0530">https://arxiv.org/abs/1304.0530</a></span></li> <li><span id="Gabrielsson2020">Br√ºel-Gabrielsson, R., Nelson, B. J., Dwaraknath, A., Skraba, P., Guibas, L. J., &amp; Carlsson, G. (2020). <i>A Topology Layer for Machine Learning</i>. <a href="https://arxiv.org/abs/1905.12200">https://arxiv.org/abs/1905.12200</a></span></li> <li><span id="Carlsson2009">Carlsson, G. E. (2009). Topology and data. <i>Bulletin of the American Mathematical Society</i>, <i>46</i>, 255‚Äì308. <a href="https://api.semanticscholar.org/CorpusID:1472609">https://api.semanticscholar.org/CorpusID:1472609</a></span></li> <li><span id="Dionysus2">Morozov, D. (2020). <i>Dionysus 2 documentation</i>. <a href="https://mrzv.org/software/dionysus2/">https://mrzv.org/software/dionysus2/</a></span></li></ol> </div> <div> <section class="comments"> <!-- Add comment form --> <div id="respond" class="comment-new"> <h2>Leave a comment</h2> <form id="input-form" method="post" action="https://api.staticforms.xyz/submit"> <input type="hidden" name="accessKey" value="4e5a5ee1-5fd9-47ed-9b85-aecdabd0c006"> <input type="hidden" name="$Date" value="1715980107"> <input type="hidden" name="$BlogPost" value="Topological features applied to the MNIST data set"> <input type="hidden" name="subject" value="Comment to blog post Fri, 17 May 2024 23:08:27 +0200"> <!-- DEBUG: hard coded redirect_url --> <input type="hidden" name="redirectTo" value="https://lalovic.io/blog/thanks"> <textarea class="wide-field" id="message" name="message" rows="8" cols="68" placeholder="Your comment (LaTeX markup accepted)" required></textarea> <div style="margin-top: 5px; margin-bottom: 5px;"> <input class="input-field" id="name" name="name" type="text" placeholder="Your name (optional)" /> <button class="btn btn-blue" id="submit-button" type="submit">Add Comment</button> </div> </form> <div id="preview-div"></div> <!-- Comment preview and rerenderMath function to apply MathJax to preview --> <script> function previewComment() { const content = document.getElementById("message").value; document.getElementById("comment-result-title").innerText = "Your comment:"; document.getElementById("comment-result").innerText = content; rerenderMath(); } function rerenderMath() { MathJax.typeset(); } var textareaInput = document.getElementById("message"); textareaInput.onkeyup = textareaInput.onkeypress = function() { document.getElementById("preview-div").innerText = this.value; rerenderMath(); } </script> </div> </section> </div> </main> <hr> <footer class="my-footer"> <p><a class="fs-5" href="#top" id="back-to-top">Back to top</a></p> <p class="fs-3 text-grey-dk-000"> CC-BY 2024, Marko Lalovic. Theme is based on <a href="https://just-the-docs.com/">Just the Docs</a>. </p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
