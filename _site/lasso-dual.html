<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Marko's Blog</title>
  <meta name="description" content="        Figure 1: Illustration when $n=p=3$. (Drawn using Mayavi library.)  ">
  <script src="/blog/assets/css/main.css/assets/main.js"></script>
  <link rel="stylesheet" href="/blog/assets/css/main.css">
  <link rel="canonical" href="https://markolalovic.github.io/blog/lasso-dual">
</head>


<body>

    <div class="page-wrapper">
        <header class="site-header">

    <link rel="apple-touch-icon" sizes="180x180" href="/docs/assets/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/docs/assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/docs/assets/img/favicon-16x16.png">
    <link rel="manifest" href="/docs/assets/img/site.webmanifest">
    <link rel="mask-icon" href="/docs/assets/img/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/docs/assets/img/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/docs/assets/img/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <div class="wrapper">
        <a class="site-title" href="/blog">Marko Lalovic</a>
        <a class="site-nav" href="https://markolalovic.github.io">About</a>
        <a class="site-nav" href="/blog">Blog</a>
    </div>

</header>


        <div class="page-content">
            <div class="wrapper">
                <div class="post">

    <header class="post-header">
        <h1 class="post-title">Lasso Dual</h1>
        <h2 class="post-subtitle">Derivation of the Lasso solution from dual formulation using projection operator and some non-obvious properties that follow from the geometry of the dual formulation.</h2>
        <p class="post-meta">Aug 1, 2021 • Marko Lalovic • 3 min read</p>
    </header>

    <article class="post-content">
        <div class="images">
  <img src="/blog/assets/posts/lasso-dual/transformation-3d.svg" />
  <div class="label">
    <strong>Figure 1:</strong> Illustration when $n=p=3$. (Drawn using <a target="_blank" href="https://docs.enthought.com/mayavi/mayavi/">Mayavi library</a>.)
  </div>
</div>

<p>Let $A: \mathbb{R}^{p} \rightarrow \mathbb{R}^{n}$ and $y \in \mathbb{R}^{p}$. Consider the Tikhonov regularization</p>

\[\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\begin{equation}
\min_{x \in \mathbb{R}^{n}}
\frac{1}{2} \norm{Ax - y}_{2}^{2} + \alpha \norm{x}_{1}.
\label{eq:min-problem}
\end{equation}\]

<p>This type of penalized regression is called Lasso; see Tibshirani’s original paper [<a href="http://statweb.stanford.edu/~tibs/lasso/lasso.pdf" target="_blank">1</a>].</p>

<p>In this post, we first derive the dual problem, then show that the solution $x^{*}$ can be determined with the help of a projection operator. Some nice and non-obvious properties of the solution $x^{*}$ follow from the geometry of the dual formulation. We finish with the observation that the Lasso solution is non-expansive as a function of $y$. This is not obvious and would probably be hard to show without the dual formulation.</p>

<!-- Section 1 -->
<h2 id="formulation-of-the-dual-problem">Formulation of the dual problem</h2>

<p>To derive the dual problem, we can introduce a dummy variable $z \in \mathbb{R}^{n}$</p>

\[\begin{equation}\nonumber
z = Ax
\end{equation}\]

<p>and reformulate the minimization problem in \eqref{eq:min-problem} as a constrained problem</p>

\[\begin{align*}
\label{eq:primal-problem}
\tag{P}
&amp;\underset{z \in \mathbb{R}^{n}, x \in \mathbb{R}^{p}}{\text{minimize}} \quad
\frac{1}{2} \norm{y - z}_{2}^{2} + \alpha \norm{x}_{1} \\
&amp;\text{subject to} \quad z = Ax
\end{align*}\]

<p>Then we can construct the Lagrangian by introducing the dual variable $p \in \mathbb{R}^{n}$ (containing $n$ Lagrange multipliers)</p>

\[\begin{equation}\nonumber
L(x, z, p) = \frac{1}{2} \norm{y - z}_{2}^{2}
+ \alpha \norm{x}_{1} + p^{T} (z - Ax)
\end{equation}\]

<p>The dual objective function is</p>

\[\begin{equation}\nonumber
g(p) = \min_{z \in \mathbb{R}^{n}, x \in \mathbb{R}^{p}}
\left\lbrace
\frac{1}{2} \norm{y - z}_{2}^{2}
+ \alpha \norm{x}_{1} + p^{T} (z - Ax)
\right\rbrace
\end{equation}\]

<p>We can split the terms depending on $z$ and $x$ and minimize each part separately</p>

\[\begin{align}\nonumber
g(p)
&amp;= \min_{z \in \mathbb{R}^{n}, x \in \mathbb{R}^{p}}
\left\lbrace
\frac{1}{2} \norm{y}_{2}^{2}
- y^{T}z
+ \frac{1}{2} \norm{z}_{2}^{2}
+ p^{T}z
+ \alpha \norm{x}_{1}
- p^{T}Ax
\right\rbrace \\[.3em]
&amp;= \min_{z \in \mathbb{R}^{n}}\nonumber
\left\lbrace
\frac{1}{2} \norm{y}_{2}^{2}
- (y - p)^{T}z
+ \frac{1}{2} \norm{z}_{2}^{2}
\right\rbrace
+ \max_{x \in \mathbb{R}^{p}}
\left\lbrace
\alpha \norm{x}_{1}
- (A^{T}p)^{T}x
\right\rbrace
\end{align}\]

<p>We can use the stationarity condition, which says that at the optimal point, the subgradient of $L(x, z, p)$ with respect to $x$ and $z$ must contain 0.</p>

<p>For the first part, since $L(x, z, p)$ is differentiable in $z$, the subgradient with respect to $z$  equals the gradient. By taking
$\frac{\partial}{\partial z} L(x, z, p)$ and setting it to $0$, we get the stationarity condition</p>

\[\begin{equation}\nonumber
z = y - p^{*}
\end{equation}\]

<p>Plugging this into the first part, we get</p>

\[\begin{align}\nonumber
&amp;\frac{1}{2}\norm{y}_{2}^{2} - (y - p^{*})^{T}(y - p^{*})
+ \frac{1}{2}\norm{y - p^{*}}_{2}^{2} \\[.3em]
&amp;=
\frac{1}{2}\norm{y}_{2}^{2}\nonumber
- \frac{1}{2}\norm{y - p^{*}}_{2}^{2}
\end{align}\]

<p>For the second part, because $\alpha \norm{x}_1$ is a non-differentiable function of $x$, we need to compute the subdifferential $\partial (\alpha \norm{x}_1)$.</p>

<p>By using the rules for the subgradient of the maximum we can derive, see [<a href="https://see.stanford.edu/materials/lsocoee364b/01-subgradients_notes.pdf" target="_blank">2</a>], that the $\partial \norm{x}_{1}$ can be expressed as</p>

\[\begin{equation}\nonumber
\partial (\norm{x}_{1})
= \lbrace g : \norm{g}_{\infty} \leq 1, g^{T} x = \norm{x}_{1}
\rbrace
\end{equation}\]

<p>and using the rule for scalar multiplication</p>

\[\begin{equation}\nonumber
\partial (\alpha\norm{x}_{1})
= \lbrace g : \norm{g}_{\infty} \leq \alpha, g^{T} x = \alpha\norm{x}_{1}
\rbrace
\end{equation}\]

<p>Thus, we get the stationarity condition</p>

\[\begin{equation}\nonumber
g = A^{T}p \in \partial \alpha \norm{x}_{1}
\end{equation}\]

<p>when</p>

\[\begin{align} \nonumber
\norm{A^{T}p}_{\infty} \leq \alpha \\[.3em]
\alpha \norm{x}_{1} - (A^{T}p)^{T}x = 0\nonumber
\end{align}\]

<p>Therefore, the dual problem is</p>

\[\begin{align*}
\label{eq:dual-problem}
\tag{D}
&amp;\max_{p \in \mathbb{R}^{n}}
\frac{1}{2}\norm{y}_{2}^{2}
- \frac{1}{2}\norm{y - p}_{2}^{2} \\[.3em]
&amp;\text{subject to} \norm{A^{T}p}_{\infty} \leq \alpha
\end{align*}\]

<!-- Section 2 -->
<h2 id="solution-of-the-dual-problem">Solution of the dual problem</h2>
<p>The solution $p^{*}$ of the dual problem can be determined with the help of a projection operator.</p>

<p>Looking at the dual problem formulation \eqref{eq:dual-problem}, we see that we can omit $\frac{1}{2}\norm{y}_{2}^{2}$, since this is constant. Then if we multiply it by 2 and flip the sign, we get an equivalent dual problem</p>

\[\begin{align*}
\label{eq:dual-problem-prime}
\tag{D'}
&amp;\min_{p \in \mathbb{R}^{n}}
\norm{y - p}_{2}^{2} \\[.3em]
&amp;\text{subject to} \norm{A^{T}p}_{\infty} \leq \alpha
\end{align*}\]

<p>A <em>projection operator</em> $P_{C}$ can be defined as</p>

\[\DeclareMathOperator*{\argmin}{arg\,min}
\begin{align}\nonumber
P_{C} \text{: } &amp; \mathbb{R}^{n} \rightarrow C \\[.3em]
&amp; y \mapsto P_{C}(y) := \argmin_{p \in C} \norm{y - p}_{2} \nonumber
\end{align}\]

<p>where $C \subset \mathbb{R}^{n}$ is closed and convex set. Looking at \eqref{eq:dual-problem-prime}, we see that $p^{*}$ is a projection</p>

\[\begin{equation}\nonumber
p^{*} = P_{C}(y)
\end{equation}\]

<p>where $C$ is equal to</p>

\[\begin{equation}\nonumber
C = \lbrace p \in \mathbb{R}^{n} :
\norm{A^{T}p}_{\infty} \leq \alpha
\rbrace
\end{equation}\]

<p>We notice that $C$ is indeed closed and convex. For example if $n=p=2$, and let</p>

\[\begin{equation}\nonumber
A^{T} = \begin{pmatrix}
a_{11} &amp; a_{21}\\
a_{12} &amp; a_{22}
\end{pmatrix}
\end{equation}\]

<p>then</p>

\[\begin{equation}\nonumber
C = \lbrace -\alpha \leq a_{11} p_{1} + a_{12} p_{2} \leq \alpha \rbrace
\cap
\lbrace -\alpha \leq a_{21} p_{1} + a_{22} p_{2} \leq \alpha \rbrace
\end{equation}\]

<p>Or we can express $C$ as</p>

\[\begin{equation}\nonumber
C = (A^{T})^{-1}(D)
\end{equation}\]

<p>where $D$ is equal to</p>

\[\begin{equation}\nonumber
D = \lbrace d \in \mathbb{R}^{p} : \norm{d}_{\infty} \leq \alpha \rbrace
\end{equation}\]

<p>Again for $p=2$</p>

\[\begin{equation}\nonumber
D = \lbrace -\alpha \leq d_{1} \leq \alpha \rbrace
\cap
\lbrace -\alpha \leq d_{2} \leq \alpha \rbrace
\end{equation}\]

<div class="images">
  <img src="/blog/assets/posts/lasso-dual/transformation-2d.svg" />
  <div class="label">
    <strong>Figure 2:</strong> Illustration when $n=p=2$.
  </div>
</div>

<!-- Section 3 -->
<h2 id="solution-of-the-primal-problem">Solution of the primal problem</h2>
<p>From optimality condition of the dual problem, we can derive the primal solution under the assumption that $A^{-1}$ exists.</p>

<p>During the formulation of the dual problem, we introduced the dummy variable $z = Ax$ and derived the stationary condition $z = y - p^{*}$.  From this, we get that every solution $x^{*}$ of \eqref{eq:primal-problem} should satisfy</p>

\[\begin{equation}\nonumber
A x^{*} = y - p^{*}
\end{equation}\]

<p>where $p^{*}$ is a solution of the dual problem \eqref{eq:dual-problem}. Therefore, if $A^{-1}$ exists, the primal solution is</p>

\[\begin{equation}\nonumber
x^{*} = A^{-1} \left( y - P_{C}(y) \right)
\end{equation}\]

<p>We notice that, since $P_{C}$ is a projection onto convex set $C$, it follows that $x^{*}$ is also non-expansive as a function of $y$; see <strong>Figure 3(a)</strong> in contrast to <strong>Figure 3(b)</strong> showing projection onto non-convex set $N$. This is not obvious and would probably be hard to show without the dual formulation.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/blog/assets/posts/lasso-dual/convex.svg" alt="convex.svg" /></th>
      <th style="text-align: center"><img src="/blog/assets/posts/lasso-dual/bean.svg" alt="bean.svg" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><span class="subfig">(a) Convex set $C$.</span></td>
      <td style="text-align: center"><span class="subfig">(b) Non-convex set $N$.</span></td>
    </tr>
  </tbody>
</table>

<div class="images">
  <div class="label">
    <strong>Figure 3:</strong> Lasso solution $x^{*}$ is non-expansive as a function of $y$.
  </div>
</div>

<h2 id="references">References</h2>
<p>[1] Tibshirani, R. (1996). Regression shrinkage and selection via the lasso. J. Royal. Statist. Soc B., Vol. 58, No. 1, pages 267-288).
<a target="_blank" href="http://statweb.stanford.edu/~tibs/lasso/lasso.pdf">http://statweb.stanford.edu/~tibs/lasso/lasso.pdf</a></p>

<p>[2] S. Boyd and L. Vandenberghe, “Subgradients Notes”, (2008), Stanford University
<a target="_blank" href="https://see.stanford.edu/materials/lsocoee364b/01-subgradients_notes.pdf">https://see.stanford.edu/materials/lsocoee364b/01-subgradients_notes.pdf</a></p>


    </article>

    <div>
      <section class="comments" id="comment-section">
  <hr>
  

  <!-- New comment form -->
  <div id="respond" class="comment__new">
    <form class="js-form form" method="post" action="https://markos-staticman.herokuapp.com/v2/entry/markolalovic/blog/main/comments">
  <input type="hidden" name="options[origin]" value="https://markolalovic.github.io/blog/lasso-dual">
  <input type="hidden" name="options[parent]" value="https://markolalovic.github.io/blog/lasso-dual">
  <input type="hidden" id="comment-replying-to-uid" name="fields[replying_to_uid]" value="">
  <input type="hidden" name="options[slug]" value="lasso-dual">
  

  <div class="textfield">
    <label for="comment-form-message"><h2>Add Comment<small><a rel="nofollow" id="cancel-comment-reply-link" href="https://markolalovic.github.io/blog/lasso-dual#respond" style="display:none;">(cancel reply)</a></small></h2>
      <textarea class="textfield__input" name="fields[message]" type="text" id="comment-form-message" placeholder="Your comment (Markdown and TeX support within $...$ or $$...$$ delimiters)" required rows="6"></textarea>
    </label>
  </div>

    <div class="textfield narrowfield">
      <label for="comment-form-name">Name
        <input class="textfield__input" name="fields[name]" type="text" id="comment-form-name" placeholder="Your name (required)" required/>
      </label>
    </div>

    <div class="textfield narrowfield">
      <label for="comment-form-email">E-mail
        <input class="textfield__input" name="fields[email]" type="email" id="comment-form-email" placeholder="Your email (optional)"/>
      </label>
    </div>

    <div class="textfield narrowfield hp">
      <label for="hp">
        <input class="textfield__input" name="fields[hp]" id="hp" type="text" placeholder="Leave blank">
      </label>
    </div>

    

    <button class="button" type="button" onclick="previewComment()">Preview</button>
    <button class="button" id="comment-form-submit">Submit</button>

    <div class="textfield">
      <h1 id="comment-result-title"></h1>
      <p id="comment-result"></p>
    </div>

</form>

<article class="modal mdl-card mdl-shadow--2dp">
  <div>
    <h3 class="modal-title js-modal-title"></h3>
  </div>
  <div class="mdl-card__supporting-text js-modal-text"></div>
  <div class="mdl-card__actions mdl-card--border">
    <button class="button mdl-button--colored mdl-js-button mdl-js-ripple-effect js-close-modal">Close</button>
  </div>
</article>

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none" >
  <symbol id="icon-loading" viewBox="149.8 37.8 499.818 525"><path d="M557.8 187.8c13.8 0 24.601-10.8 24.601-24.6S571.6 138.6 557.8 138.6s-24.6 10.8-24.6 24.6c0 13.2 10.8 24.6 24.6 24.6zm61.2 90.6c-16.8 0-30.6 13.8-30.6 30.6s13.8 30.6 30.6 30.6 30.6-13.8 30.6-30.6c.6-16.8-13.2-30.6-30.6-30.6zm-61.2 145.2c-20.399 0-36.6 16.2-36.6 36.601 0 20.399 16.2 36.6 36.6 36.6 20.4 0 36.601-16.2 36.601-36.6C595 439.8 578.2 423.6 557.8 423.6zM409 476.4c-24 0-43.2 19.199-43.2 43.199s19.2 43.2 43.2 43.2 43.2-19.2 43.2-43.2S433 476.4 409 476.4zM260.8 411c-27 0-49.2 22.2-49.2 49.2s22.2 49.2 49.2 49.2 49.2-22.2 49.2-49.2-22.2-49.2-49.2-49.2zm-10.2-102c0-27.6-22.8-50.4-50.4-50.4-27.6 0-50.4 22.8-50.4 50.4 0 27.6 22.8 50.4 50.4 50.4 27.6 0 50.4-22.2 50.4-50.4zm10.2-199.8c-30 0-54 24-54 54s24 54 54 54 54-24 54-54-24.6-54-54-54zM409 37.8c-35.4 0-63.6 28.8-63.6 63.6S374.2 165 409 165s63.6-28.8 63.6-63.6-28.2-63.6-63.6-63.6z"/>
  </symbol>
</svg>



  </div>
</section>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="/blog/assets/main.js"></script>


    </div>
</div>

            </div>
        </div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <ul class="social-media-list">
      
      <li>
        <a href="https://github.com/markolalovic" target="_blank">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">markolalovic</span>
        </a>
      </li>
      

      
      <li>
        <a href="https://twitter.com/MarkoLalovic" target="_blank">
          <span class="icon  icon--twitter">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
              c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
            </svg>
          </span>

          <span class="username">MarkoLalovic</span>
        </a>
        <span class="post-meta" style="float: right">
          The website content is licensed <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY 4.0</a>.
        </span>
      </li>
      
    </ul>
  </div>

</footer>


    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: {
          equationNumbers: { autoNumber: "AMS" },
          tagSide: "right"
        },
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

</body>

</html>
